# Hoiku CRM ドキュメント

> **重要**: このディレクトリには、AIエージェントがシステムを理解し、正確な判断を行うためのドキュメントが含まれています。

## ドキュメントの目的

これらのドキュメントは、AIエージェントが以下の判断を正確に行えるよう、システムの目的・意図・ビジネスロジックを明確に記載しています：

- 機能追加・修正時の判断基準
- データの扱い方（どこから取得し、どこに保存するか）
- UIの動作（ボタン操作時の挙動、画面遷移）
- バリデーションルール（許可される入力、エラー条件）
- ビジネスロジック（なぜその機能があるか、どう動作すべきか）

## ドキュメント一覧

### 1. [システム目的と設計思想](./SYSTEM_PURPOSE.md) ⭐ **最初に読む**

**AIエージェントが最初に参照すべきドキュメント**

- システムの目的（なぜ作られたか）
- 解決すべき課題
- 設計の基本方針
- 重要な制約事項
- 変更してはいけない原則

**読むべきタイミング**: システムについて理解を深める時、判断に迷った時

---

### 2. [画面仕様とビジネスロジック](./SCREEN_LOGIC.md)

**各画面の「なぜ」と「何をすべきか」を明確に記載**

各画面ごとに以下を記載：
- 画面の目的とユーザーの意図
- 主要機能とその理由
- データの扱い方（取得元、保存先）
- UIの動作（ボタン操作、画面遷移）
- バリデーションルール
- 判断が必要な場面

**対象画面**:
- ダッシュボード (`/`)
- 今日のタスク (`/tasks`)
- 求職者管理 (`/candidates`)
- 求職者詳細 (`/candidates/[id]`)
- 成約管理 (`/contracts`)
- メンバー (`/members`)
- 面接一覧 (`/interviews`)

**読むべきタイミング**: 特定の画面を実装・修正する時

---

### 3. [データフローと状態管理](./DATA_FLOW.md)

**データがどこから来て、どこに行くかを明確に**

- データソース一覧（mock-data, Supabase, localStorage）
- 各画面で使用するデータとその取得元
- データ更新時の流れ
- 状態管理の方針（useState, useMemo, localStorageの使い分け）
- タイムラインイベントの仕組み
- データの整合性を保つためのルール

**読むべきタイミング**: データを扱う時、状態管理を実装する時

---

### 4. [API仕様（認証・ユーザー管理）](./API_SPEC.md)

**認証・ユーザー管理APIの仕様を整理**

- `/api/auth/*` のエンドポイント
- `/api/users/*` のエンドポイント
- 権限とレスポンス形式

**読むべきタイミング**: 認証やユーザー管理APIを実装・修正する時

---

### 5. [ビジネスルール集](./BUSINESS_RULES.md)

**システムの動作を決定する重要なルール**

- ステータス遷移ルール
- 担当者変更時のルール
- タイムライン記録のルール
- 成約時の自動処理
- 優先度の自動判定ルール
- 計算ロジック（KPI、達成率、成約単価など）

**読むべきタイミング**: ビジネスロジックを実装する時、自動処理を実装する時

---

### 6. [画面遷移とナビゲーション](./NAVIGATION.md)

**画面間の関係と遷移ルール**

- 画面遷移図（Mermaid）
- 各画面から遷移できる画面
- URLパラメータの意味と使い方
- 戻るボタンの動作（どこに戻るか）

**読むべきタイミング**: 画面遷移を実装する時、リンクを追加する時

---

### 7. [AIエージェント向け判断ガイド](./AI_AGENT_GUIDE.md)

**AIエージェントが判断に迷った時に参照**

- よくある判断ミスと正しい判断
- 変更を加える前に確認すべきこと
- データを変更する際の注意点
- UIを変更する際の注意点
- 新機能を追加する際の判断基準

**読むべきタイミング**: 判断に迷った時、よくあるミスを避けたい時

---

### 8. [全画面機能要件書](./ALL_SCREEN_REQUIREMENTS.md) ⭐ **新規追加**

**各画面の詳細な機能要件をまとめた包括的なドキュメント**

- 各画面の目的と主要機能
- UIの詳細（カラム、ボタン、フォームなど）
- ユースケース
- データベース要件
- 実装優先度

**読むべきタイミング**: 新機能を実装する時、画面の仕様を確認する時

---

### 9. [ダッシュボード要件詳細](./DASHBOARD_REQUIREMENTS.md)

**ダッシュボードの期間フィルタリングとKPI計算に関する詳細な要件**

- 期間選択機能の実装要件
- KPIカードの計算ロジック（期間対応）
- 予算管理機能の要件
- 実装チェックリスト

**読むべきタイミング**: ダッシュボードを実装・修正する時

---

### 10. [実装チェックリスト](./IMPLEMENTATION_CHECKLIST.md) ⭐ **新規追加**

**システム完成までに必要な実装項目をまとめたチェックリスト**

- 優先度別のタスク一覧
- 各画面のCRUD機能
- 認証・認可
- データベース要件
- テスト・デプロイ

**読むべきタイミング**: 実装を進める時、進捗を確認する時

---

## ドキュメントの参照順序

AIエージェントが作業を開始する時は、以下の順序でドキュメントを参照してください：

### 1. 最初に（必須）

**[システム目的と設計思想](./SYSTEM_PURPOSE.md)** を読む
- システムの目的と基本方針を理解する

### 2. 作業内容に応じて

- **画面を実装・修正する時**: [画面仕様とビジネスロジック](./SCREEN_LOGIC.md)
- **データを扱う時**: [データフローと状態管理](./DATA_FLOW.md)
- **認証/ユーザー管理APIを扱う時**: [API仕様（認証・ユーザー管理）](./API_SPEC.md)
- **ビジネスロジックを実装する時**: [ビジネスルール集](./BUSINESS_RULES.md)
- **画面遷移を実装する時**: [画面遷移とナビゲーション](./NAVIGATION.md)

### 3. 判断に迷った時

**[AIエージェント向け判断ガイド](./AI_AGENT_GUIDE.md)** を参照
- よくある判断ミスと正しい判断を確認

## ドキュメントの更新方針

### 更新が必要なタイミング

- 新しい画面が追加された時
- ビジネスルールが変更された時
- データフローが変更された時
- 新しい機能が追加された時

### 更新時の注意点

- 既存のドキュメントとの整合性を保つ
- 関連するドキュメントも同時に更新する
- 具体例を豊富に記載する
- AIエージェントが理解しやすい表現を使用する

## 既存ドキュメントとの関係

このディレクトリのドキュメントは、以下の既存ドキュメントを補完します：

- `01_プロジェクト概要.md` - プロジェクトの背景と技術スタック
- `02_要件定義・機能一覧.md` - 機能要件の詳細
- `03_データモデル設計.md` - データベース設計
- `04_要件まとめ_チーム共有用.md` - チーム向けの要件説明
- `画面名称・構成ドキュメント.md` - 開発時のリファレンス

**違い**:
- 既存ドキュメント: プロジェクトの全体像、要件、設計を記載
- このディレクトリのドキュメント: AIエージェント向けに「なぜ」「何をすべきか」を明確に記載

## クイックリファレンス

### よくある質問

**Q: データはどこから取得するか？**
A: [データフローと状態管理](./DATA_FLOW.md) を参照。プロトタイプでは`mock-data.ts`から取得。

**Q: ステータスを変更したら何をすべきか？**
A: [ビジネスルール集](./BUSINESS_RULES.md) を参照。`closed_won`の場合は自動的に`contracts`にレコードを作成。

**Q: 画面遷移はどう実装するか？**
A: [画面遷移とナビゲーション](./NAVIGATION.md) を参照。Next.jsの`Link`コンポーネントまたは`router.push()`を使用。

**Q: 判断に迷った時は？**
A: [AIエージェント向け判断ガイド](./AI_AGENT_GUIDE.md) を参照。よくある判断ミスと正しい判断を確認。

## 関連リソース

- [プロジェクトルートのREADME](../README.md) - プロジェクトの概要
- [DATABASE_DESIGN.md](../DATABASE_DESIGN.md) - データベース設計の詳細
- [SETUP.md](../SETUP.md) - 開発環境のセットアップ

---

**最終更新**: 2025年1月22日

---

## ドキュメント更新履歴

- 2025-01-22: 全画面機能要件書（ALL_SCREEN_REQUIREMENTS.md）を追加
- 2025-01-22: ダッシュボード要件詳細（DASHBOARD_REQUIREMENTS.md）を追加
- 2025-01-22: 実装チェックリスト（IMPLEMENTATION_CHECKLIST.md）を追加
- 2025-01-22: SCREEN_LOGIC.mdを更新（期間フィルタリング要件を追加）
