# push したのに本番に反映されないとき

## 本番が「本当に最新ビルド」か確認する

ビルド成功・URL も本番なのに古い UI（右上の検索窓・通知ボタンが残る、求職者一覧の検索が Enter で動かない など）が出る場合は、**本番が古いビルドを表示している**可能性が高い。

1. **ブラウザで開発者ツール**（F12）→ **Elements**（要素）タブ
2. `<header>` の内側にある `<div class="w-0 flex-none" ...>` を探す
3. その div に **`data-app-rev="20260205-no-search"`** があるか確認
   - **ある** → このリポジトリの最新コードが本番で動いている。別原因（キャッシュなど）を疑う
   - **ない** / 別の値 → 本番は古いビルド。下記「デプロイ元」を確認する

---

## 1. デプロイが「main の push で自動」か確認する

- **Vercel** の場合: ダッシュボード → プロジェクト → Settings → Git → 「Production Branch」が `main` か確認
- **Netlify** など: 同様に「本番ブランチ」が push しているブランチか確認

別ブランチに push していると本番は更新されない。

---

## 2. ビルドが成功しているか確認する（いちばん多い原因）

push すると「デプロイが走るがビルドで失敗している」ことが多い。

- **Vercel**: [vercel.com](https://vercel.com) にログイン → プロジェクト → **Deployments** タブ → 直近のデプロイをクリック → **Building** が Failed になっていないか、ログにエラーが出ていないか確認
- **Netlify**: サイト → Deploys → 失敗したデプロイのログを確認

ビルドが失敗していると、古い本番のままになる。ログのエラーを直して再度 push するか、「Redeploy」で再実行する。

---

## 3. 本当に本番 URL を見ているか確認する

- プレビュー用 URL（例: `xxx-git-main-xxx.vercel.app`）と、本番 URL（例: `hoiku-crm.vercel.app` など）が違う場合がある
- 本番ドメインを開いているか、ブックマークやリンクが古い URL になっていないか確認

---

## 4. キャッシュの可能性

- ブラウザのハードリロード: **Ctrl+Shift+R**（Mac: **Cmd+Shift+R**）
- シークレットウィンドウで開き直す
- Vercel/Netlify の「Redeploy」で「Clear cache and deploy」があれば試す

---

## 5. 手動デプロイにしている場合

サーバーや別のホスティングに「手動でデプロイ」している場合は、push したあとに**デプロイ作業を自分で実行**する必要がある。  
「push = 自動で本番更新」になっていないなら、デプロイ手順をメモしておくと忘れない。

---

## チェックリスト（push 後に本番が変わらないとき）

1. [ ] push したブランチが、本番の対象ブランチ（多くは `main`）か
2. [ ] ホスティングの Deployments で、直近のビルドが **Success** か
3. [ ] 見ている URL が本番のドメインか（プレビュー用ではないか）
4. [ ] ブラウザのハードリロード or シークレットで開き直したか

ここまでやっても反映されない場合は、使っているホスティング名（Vercel / Netlify / その他）と、Deployments の画面の状態（成功/失敗）をメモしておくと原因を切り分けやすい。

---

## 本番が「別ブランチ・別リポジトリ」をビルドしていないか

- Vercel/Netlify の **プロジェクト設定** → **Git** で、接続している **リポジトリ名・ブランチ** を確認
- 普段 `git push` しているリポジトリ・ブランチと一致しているか
- 別の Fork や「本番用」リポジトリにしか push していない場合、そちらを push するか、本番の接続先を今のリポジトリに変更する必要がある
